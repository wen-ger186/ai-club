<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç®¡ç†æ§åˆ¶å° - ai-club.fun</title>
    <script src="//code.bdstatic.com/npm/leancloud-storage@4.12.0/dist/av-min.js"></script>
    <link rel="stylesheet" href="style.css">
    <style>
        body { background-color: #f3f4f6; } /* åå°ç°è‰²èƒŒæ™¯ */
        .dashboard-container { max-width: 1200px; margin: 30px auto; background: #fff; padding: 2rem; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        .admin-nav { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; border-bottom: 1px solid #eee; padding-bottom: 20px; }
        .hidden { display: none !important; }
        .btn-xs { padding: 2px 8px; font-size: 0.8rem; border-radius: 4px; border: 1px solid #ccc; cursor: pointer; }
        /* ç»§æ‰¿ style.css çš„åŸºç¡€æ ·å¼ï¼Œæ­¤å¤„åªè¡¥æ¼ */
        table { width: 100%; border-collapse: collapse; }
        th, td { border: 1px solid #eee; padding: 10px; text-align: left; }
        th { background: #f9fafb; }
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: flex; justify-content: center; align-items: center; z-index: 2000; }
        .modal-box { background: white; padding: 30px; border-radius: 8px; width: 450px; }
        .read-only { background-color: #f3f4f6; color: #888; cursor: not-allowed; }
    </style>
</head>
<body>

    <div class="dashboard-container">
        <div class="admin-nav">
            <a href="index.html" style="text-decoration:none; color:#666;">&larr; è¿”å›å‰å°é¦–é¡µ</a>
            <div>
                <span id="user-display-name" style="font-weight:bold; margin-right:10px;">ç®¡ç†å‘˜</span>
                <button onclick="logoutAction()" style="color:red; border:1px solid red; background:white; padding:4px 10px; cursor:pointer;">é€€å‡ºç³»ç»Ÿ</button>
            </div>
        </div>

        <h2 style="border-left:5px solid #2563EB; padding-left:15px; margin-bottom:10px;">æ§åˆ¶å°</h2>
        <div id="identity-role" style="display:inline-block; padding:5px 10px; background:#e0f2fe; color:#0284c7; font-weight:bold; border-radius:4px; margin-bottom:20px;">åŠ è½½ä¸­...</div>

        <div id="top-admin-tools" style="display:none; background:#f0f5ff; padding:20px; border-radius:8px; margin-bottom:30px; border:1px dashed #1890ff;">
            <h4 style="margin:0 0 15px 0; color:#1890ff;">ğŸ›¡ï¸ å¹³å°ç®¡ç†æ“ä½œ</h4>
            <div style="display:flex; gap:10px;">
                <button onclick="openAddAdminModal()">+ å¼€åˆ†åº—/ä»»å‘½ç®¡ç†å‘˜</button>
                <button onclick="openTransferModal()">â‡Œ ä¼šå‘˜åˆ†é…/è½¬ä¼š</button>
                <button id="btn-batch-delete" onclick="deleteBatch()" style="color:white; background:red; border:none; display:none;">ğŸ—‘ æ‰¹é‡åˆ é™¤</button>
            </div>
        </div>
        
        <div id="admin-panel" style="display:none;">
            <div style="margin-bottom:15px; display:flex; justify-content:space-between;">
                <h3>ğŸ“‚ æ¡£æ¡ˆæ•°æ®åº“</h3>
                <button onclick="exportSelected()">ğŸ“¥ å¯¼å‡ºæŠ¥è¡¨</button>
            </div>
            <div style="overflow-x:auto;">
                <table id="member-table">
                    <thead>
                        <tr>
                            <th width="30"><input type="checkbox" id="select-all" onclick="toggleSelectAll()"></th>
                            <th width="50">å¤´åƒ</th>
                            <th width="60">æ“ä½œ</th>
                            <th>å§“å</th>
                            <th>çŠ¶æ€/ä¿±ä¹éƒ¨</th>
                            <th>æ€§åˆ«</th>
                            <th>æ‰‹æœºå·</th>
                            <th>å­¦æ ¡</th>
                        </tr>
                    </thead>
                    <tbody id="member-list-body"></tbody>
                </table>
            </div>
        </div>

        <div id="profile-panel" style="display:none; max-width:600px; margin:0 auto;">
            <h3 style="text-align:center;">æ¡£æ¡ˆè¯¦æƒ…</h3>
            <div style="text-align:center; margin-bottom:20px;">
                <img id="p-photo-preview" src="" style="width:100px; height:100px; border-radius:50%; object-fit:cover; border:3px solid #eee;">
                <br>
                <label for="p-photo-file" style="cursor:pointer; color:#2563EB; display:inline-block; margin-top:5px;">ğŸ“¸ æ›´æ¢ç…§ç‰‡</label>
                <input type="file" id="p-photo-file" accept="image/*" onchange="previewImage(this)" style="display:none;">
            </div>

            <p>å§“å: <input type="text" id="p-name" style="width:100%; padding:8px; margin-bottom:10px;"></p>
            <p>æ€§åˆ«: <select id="p-gender" style="width:100%; padding:8px; margin-bottom:10px;"><option value="ç”·">ç”·</option><option value="å¥³">å¥³</option></select></p>
            <p>æ‰‹æœº: <input type="text" id="p-phone" style="width:100%; padding:8px; margin-bottom:10px;"></p>
            <p>ä¿±ä¹éƒ¨ (è½¬ä¼š): 
                <select id="p-club-select" style="width:100%; padding:8px; margin-bottom:10px;">
                    <option value="å¾…åˆ†é…">å¾…åˆ†é…</option>
                    <option value="è-æ¾æ¹–ä¿±ä¹éƒ¨">è-æ¾æ¹–ä¿±ä¹éƒ¨</option>
                    <option value="è-å—åŸä¿±ä¹éƒ¨">è-å—åŸä¿±ä¹éƒ¨</option>
                    <option value="è-è™é—¨ä¿±ä¹éƒ¨">è-è™é—¨ä¿±ä¹éƒ¨</option>
                </select>
            </p>
            <p>èº«ä»½è¯: <input type="text" id="p-idcard" style="width:100%; padding:8px; margin-bottom:10px;"></p>
            <p>å­¦æ ¡: <input type="text" id="p-school" style="width:100%; padding:8px; margin-bottom:10px;"></p>
            <p>ç­çº§: <input type="text" id="p-class" style="width:100%; padding:8px; margin-bottom:10px;"></p>
            <p>å¾®ä¿¡: <input type="text" id="p-wechat" style="width:100%; padding:8px; margin-bottom:10px;"></p>
            
            <div style="text-align:center; margin-top:20px;">
                <button onclick="saveProfileData()" style="padding:10px 30px; background:#2563EB; color:white; border:none; border-radius:4px;">ä¿å­˜</button>
                <button onclick="closeDetailView()" style="padding:10px 30px; background:#eee; border:none; margin-left:10px; border-radius:4px;">è¿”å›</button>
            </div>
        </div>
    </div>

    <div id="modal-add-admin" class="modal-overlay hidden">
        <div class="modal-box">
            <h3>å¼€åˆ†åº— / ä»»å‘½ç®¡ç†å‘˜</h3>
            <p>è´¦å·: <input type="text" id="new-admin-user" style="width:100%; margin-bottom:10px;"></p>
            <p>å¯†ç : <input type="text" id="new-admin-pass" value="123456" style="width:100%; margin-bottom:10px;"></p>
            <p>å§“å: <input type="text" id="new-admin-name" style="width:100%; margin-bottom:10px;"></p>
            <p>è§’è‰²: <select id="new-admin-role" style="width:100%; margin-bottom:10px;"></select></p>
            <p>è´Ÿè´£åº—å: <input type="text" id="new-admin-club" placeholder="å¦‚ï¼šè-åšè¡—ä¿±ä¹éƒ¨" style="width:100%; margin-bottom:10px;"></p>
            <button onclick="confirmAddAdmin()">ç¡®è®¤</button> <button onclick="closeModal('modal-add-admin')">å–æ¶ˆ</button>
        </div>
    </div>

    <div id="modal-transfer" class="modal-overlay hidden">
        <div class="modal-box">
            <h3>ä¼šå‘˜åˆ†é… / è½¬ä¼š</h3>
            <p>ç›®æ ‡ä¿±ä¹éƒ¨: <input type="text" placeholder="è¾“å…¥åº—å" style="width:100%; margin-bottom:10px;"></p>
            <button onclick="confirmTransfer()">ç¡®è®¤</button> <button onclick="closeModal('modal-transfer')">å–æ¶ˆ</button>
        </div>
    </div>

    <script>window.isDashboardPage = true;</script>
    <script src="logic.js"></script>
</body>
</html>
